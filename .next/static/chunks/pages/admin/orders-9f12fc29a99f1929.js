(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1426],{76376:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/orders",function(){return r(68910)}])},68910:function(e,t,r){"use strict";r.r(t);var o=r(85893),s=r(67294),a=r(11163),n=r(66308),l=r(68482),c=r(57407),i=r(65858);t.default=(0,i.Q)((function(){const[e,t]=(0,s.useState)([]),[r,i]=(0,s.useState)(!0),[d,u]=(0,s.useState)({show:!1,message:"",type:"success"}),m=(0,a.useRouter)(),h=[{key:"orderNumber",label:"Order #",filterable:!0,render:e=>"#".concat(e.orderNumber)},{key:"customer",label:"Customer",filterable:!0,render:e=>(0,o.jsxs)("div",{children:[(0,o.jsx)("div",{className:"font-medium",children:e.customer.name}),(0,o.jsx)("div",{className:"text-sm text-gray-500",children:e.customer.email})]})},{key:"items",label:"Items",render:e=>(0,o.jsxs)("div",{className:"text-sm",children:[e.items.length," ",1===e.items.length?"item":"items"]})},{key:"total",label:"Total",render:e=>"\u20b9".concat(e.total.toFixed(2))},{key:"status",label:"Status",filterable:!0,render:e=>(0,o.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat("completed"===e.status?"bg-green-100 text-green-800":"processing"===e.status?"bg-blue-100 text-blue-800":"cancelled"===e.status?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"),children:e.status.charAt(0).toUpperCase()+e.status.slice(1)})},{key:"paymentStatus",label:"Payment",filterable:!0,render:e=>(0,o.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat("paid"===e.paymentStatus?"bg-green-100 text-green-800":"pending"===e.paymentStatus?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"),children:e.paymentStatus.charAt(0).toUpperCase()+e.paymentStatus.slice(1)})},{key:"createdAt",label:"Date",render:e=>new Date(e.createdAt).toLocaleDateString()}];(0,s.useEffect)((()=>{x()}),[]);const x=async()=>{try{const e=await fetch("http://localhost:5001/api/admin/orders",{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}});if(!e.ok)throw new Error("Failed to fetch orders");const r=await e.json();t(r)}catch(e){console.error("Error fetching orders:",e),p("Failed to fetch orders","error")}finally{i(!1)}},p=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success";u({show:!0,message:e,type:t})},g=async(e,t)=>{try{if(!(await fetch("http://localhost:5001/api/admin/orders/".concat(t,"/").concat(e),{method:"PATCH",headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}})).ok)throw new Error("Failed to ".concat(e," order"));p("Order ".concat(e,"d successfully")),x()}catch(r){console.error("Error ".concat(e,"ing order:"),r),p("Failed to ".concat(e," order"),"error")}},b=async(e,t)=>{try{if(!(await fetch("http://localhost:5001/api/admin/orders/bulk/".concat(e),{method:"POST",headers:{Authorization:"Bearer ".concat(localStorage.getItem("token")),"Content-Type":"application/json"},body:JSON.stringify({ids:t})})).ok)throw new Error("Failed to ".concat(e," orders"));p("Orders ".concat(e,"d successfully")),x()}catch(r){console.error("Error ".concat(e,"ing orders:"),r),p("Failed to ".concat(e," orders"),"error")}},f=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"csv";try{const t=await fetch("http://localhost:5001/api/admin/orders/export?format=".concat(e),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}});if(!t.ok)throw new Error("Failed to export orders");const r=await t.blob(),o=window.URL.createObjectURL(r),s=document.createElement("a");s.href=o,s.download="orders.".concat(e),document.body.appendChild(s),s.click(),window.URL.revokeObjectURL(o),document.body.removeChild(s),p("Orders exported successfully")}catch(t){console.error("Error exporting orders:",t),p("Failed to export orders","error")}};return r?(0,o.jsx)(n.Z,{children:(0,o.jsx)("div",{className:"flex items-center justify-center h-screen",children:(0,o.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})})}):(0,o.jsx)(n.Z,{children:(0,o.jsxs)("div",{className:"p-6",children:[(0,o.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,o.jsx)("h1",{className:"text-2xl font-semibold text-gray-800",children:"Orders Management"}),(0,o.jsx)("div",{className:"flex space-x-4",children:(0,o.jsxs)("div",{className:"relative inline-block text-left",children:[(0,o.jsxs)("button",{type:"button",className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",onClick:()=>document.getElementById("exportMenu").classList.toggle("hidden"),children:["Export",(0,o.jsx)("svg",{className:"-mr-1 ml-2 h-5 w-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:(0,o.jsx)("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),(0,o.jsx)("div",{id:"exportMenu",className:"hidden origin-top-right absolute right-0 mt-2 w-48 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 focus:outline-none",role:"menu","aria-orientation":"vertical","aria-labelledby":"export-menu",children:(0,o.jsxs)("div",{className:"py-1",role:"none",children:[(0,o.jsx)("button",{onClick:()=>f("csv"),className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",role:"menuitem",children:"Export as CSV"}),(0,o.jsx)("button",{onClick:()=>f("excel"),className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",role:"menuitem",children:"Export as Excel"}),(0,o.jsx)("button",{onClick:()=>f("pdf"),className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",role:"menuitem",children:"Export as PDF"})]})})]})})]}),(0,o.jsx)(l.Z,{columns:h,data:e,onRowClick:e=>{m.push("/admin/orders/".concat(e.id))},actions:e=>(0,o.jsxs)("div",{className:"flex justify-end space-x-2",children:["pending"===e.status&&(0,o.jsx)("button",{onClick:t=>{t.stopPropagation(),g("process",e.id)},className:"text-blue-600 hover:text-blue-900",children:"Process"}),"processing"===e.status&&(0,o.jsx)("button",{onClick:t=>{t.stopPropagation(),g("complete",e.id)},className:"text-green-600 hover:text-green-900",children:"Complete"}),"cancelled"!==e.status&&"completed"!==e.status&&(0,o.jsx)("button",{onClick:t=>{t.stopPropagation(),g("cancel",e.id)},className:"text-red-600 hover:text-red-900",children:"Cancel"})]}),bulkActions:[{label:"Process",action:e=>b("process",e)},{label:"Complete",action:e=>b("complete",e)},{label:"Cancel",action:e=>b("cancel",e)}]}),(0,o.jsx)(c.Z,{show:d.show,message:d.message,type:d.type,onClose:()=>u((e=>({...e,show:!1})))})]})})}))}},function(e){e.O(0,[3424,6920,9881,9774,2888,179],(function(){return t=76376,e(e.s=t);var t}));var t=e.O();_N_E=t}]);