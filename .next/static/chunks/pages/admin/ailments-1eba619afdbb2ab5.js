(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4154],{14463:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/ailments",function(){return s(12595)}])},12595:function(e,t,s){"use strict";s.r(t);var a=s(85893),i=s(67294),n=s(11163),o=s(66308),r=(s(68482),s(57407)),l=s(65858);const c="https://miet-backend-five.vercel.app";t.default=(0,l.Q)((function(){const[e,t]=(0,i.useState)([]),[s,l]=(0,i.useState)(!0),[d,m]=(0,i.useState)({show:!1,message:"",type:""}),[u,x]=(0,i.useState)(!1),[p,h]=(0,i.useState)(null),[f,g]=(0,i.useState)({name:"",description:"",category_id:""}),[y,b]=(0,i.useState)([]);(0,n.useRouter)(),(0,i.useEffect)((()=>{w(),j()}),[]);const w=async()=>{try{const e=localStorage.getItem("token"),s=await fetch("".concat(c,"/api/admin/ailments"),{headers:{Authorization:"Bearer ".concat(e),Accept:"application/json"}});if(!s.ok)throw new Error("Failed to fetch ailments");const a=await s.json();t(a)}catch(e){m({show:!0,message:e.message||"Failed to fetch ailments",type:"error"})}finally{l(!1)}},j=async()=>{try{const e=localStorage.getItem("token"),t=await fetch("".concat(c,"/api/admin/categories"),{headers:{Authorization:"Bearer ".concat(e),Accept:"application/json"}});if(!t.ok)throw new Error("Failed to fetch categories");const s=await t.json();b(s)}catch(e){console.error("Error fetching categories:",e)}},v=async e=>{if(window.confirm("Are you sure you want to delete this ailment?"))try{const t=localStorage.getItem("token");if(!(await fetch("".concat(c,"/api/admin/ailments/").concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(t),Accept:"application/json"}})).ok)throw new Error("Failed to delete ailment");m({show:!0,message:"Ailment deleted successfully",type:"success"}),w()}catch(t){m({show:!0,message:t.message,type:"error"})}};return s?(0,a.jsx)(o.Z,{children:(0,a.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})})}):(0,a.jsxs)(o.Z,{children:[(0,a.jsx)("div",{className:"py-6",children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 md:px-8",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("h1",{className:"text-2xl font-semibold text-gray-900",children:"Ailments"}),(0,a.jsx)("button",{onClick:()=>{h(null),g({name:"",description:"",category_id:""}),x(!0)},className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Add Ailment"})]}),(0,a.jsx)("div",{className:"mt-8 flex flex-col",children:(0,a.jsx)("div",{className:"-my-2 -mx-4 overflow-x-auto sm:-mx-6 lg:-mx-8",children:(0,a.jsx)("div",{className:"inline-block min-w-full py-2 align-middle md:px-6 lg:px-8",children:(0,a.jsx)("div",{className:"overflow-hidden shadow ring-1 ring-black ring-opacity-5 md:rounded-lg",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-300",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{scope:"col",className:"py-3.5 pl-4 pr-3 text-left text-sm font-semibold text-gray-900 sm:pl-6",children:"Name"}),(0,a.jsx)("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",children:"Description"}),(0,a.jsx)("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",children:"Category"}),(0,a.jsx)("th",{scope:"col",className:"relative py-3.5 pl-3 pr-4 sm:pr-6",children:(0,a.jsx)("span",{className:"sr-only",children:"Actions"})})]})}),(0,a.jsx)("tbody",{className:"divide-y divide-gray-200 bg-white",children:e.map((e=>{var t;return(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:"whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium text-gray-900 sm:pl-6",children:e.name}),(0,a.jsx)("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:e.description}),(0,a.jsx)("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:(null===(t=y.find((t=>t.id===e.category_id)))||void 0===t?void 0:t.name)||"N/A"}),(0,a.jsxs)("td",{className:"relative whitespace-nowrap py-4 pl-3 pr-4 text-right text-sm font-medium sm:pr-6",children:[(0,a.jsx)("button",{onClick:()=>(e=>{h(e),g({name:e.name,description:e.description,category_id:e.category_id}),x(!0)})(e),className:"text-blue-600 hover:text-blue-900 mr-4",children:"Edit"}),(0,a.jsx)("button",{onClick:()=>v(e.id),className:"text-red-600 hover:text-red-900",children:"Delete"})]})]},e.id)}))})]})})})})})]})}),u&&(0,a.jsx)("div",{className:"fixed z-10 inset-0 overflow-y-auto",children:(0,a.jsxs)("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[(0,a.jsx)("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:(0,a.jsx)("div",{className:"absolute inset-0 bg-gray-500 opacity-75"})}),(0,a.jsx)("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:(0,a.jsxs)("form",{onSubmit:async e=>{e.preventDefault();try{const e=localStorage.getItem("token"),t=p?"".concat(c,"/api/admin/ailments/").concat(p.id):"".concat(c,"/api/admin/ailments");if(!(await fetch(t,{method:p?"PUT":"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(f)})).ok)throw new Error(p?"Failed to update ailment":"Failed to create ailment");m({show:!0,message:p?"Ailment updated successfully":"Ailment created successfully",type:"success"}),x(!1),h(null),g({name:"",description:"",category_id:""}),w()}catch(t){m({show:!0,message:t.message,type:"error"})}},children:[(0,a.jsxs)("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:[(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700",children:"Name"}),(0,a.jsx)("input",{type:"text",name:"name",id:"name",required:!0,value:f.name,onChange:e=>g({...f,name:e.target.value}),className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700",children:"Description"}),(0,a.jsx)("textarea",{name:"description",id:"description",rows:"3",value:f.description,onChange:e=>g({...f,description:e.target.value}),className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{htmlFor:"category_id",className:"block text-sm font-medium text-gray-700",children:"Category"}),(0,a.jsxs)("select",{name:"category_id",id:"category_id",required:!0,value:f.category_id,onChange:e=>g({...f,category_id:e.target.value}),className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",children:[(0,a.jsx)("option",{value:"",children:"Select a category"}),y.map((e=>(0,a.jsx)("option",{value:e.id,children:e.name},e.id)))]})]})]}),(0,a.jsxs)("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[(0,a.jsx)("button",{type:"submit",className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-600 text-base font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm",children:p?"Update":"Create"}),(0,a.jsx)("button",{type:"button",onClick:()=>{x(!1),h(null),g({name:"",description:"",category_id:""})},className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm",children:"Cancel"})]})]})})]})}),(0,a.jsx)(r.Z,{show:d.show,message:d.message,type:d.type,onClose:()=>m({...d,show:!1})})]})}))}},function(e){e.O(0,[3424,6920,9881,9774,2888,179],(function(){return t=14463,e(e.s=t);var t}));var t=e.O();_N_E=t}]);